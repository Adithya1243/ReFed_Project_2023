library(networkD3)
library(readxl)
# File path to your Excel file
file_path <- "crops_file.xlsx" # Replace with your file path
# Read data from Excel sheets
nodes <- read_excel(file_path, sheet = "nodes")
links <- read_excel(file_path, sheet = "links")
# Convert source and target from character to numeric index based on nodes
links$source <- match(links$source, nodes$name) - 1
links$target <- match(links$target, nodes$name) - 1
# Generate the Sankey diagram
# If you have a color column in your links sheet, use LinkGroup='color'
sankey <- sankeyNetwork(Links=links, Nodes=nodes, Source='source',
Target='target', Value='value', NodeID='name',
units='TWh', NodeGroup='name', LinkGroup='color')
# Print the diagram
print(sankey)
library(networkD3)
library(readxl)
# File path to your Excel file
file_path <- "meat_file.xlsx" # Replace with your file path
# Read data from Excel sheets
nodes <- read_excel(file_path, sheet = "nodes")
links <- read_excel(file_path, sheet = "links")
# Convert source and target from character to numeric index based on nodes
links$source <- match(links$source, nodes$name) - 1
links$target <- match(links$target, nodes$name) - 1
# Generate the Sankey diagram
# If you have a color column in your links sheet, use LinkGroup='color'
sankey <- sankeyNetwork(Links=links, Nodes=nodes, Source='source',
Target='target', Value='value', NodeID='name',
units='TWh', NodeGroup='name', LinkGroup='color')
# Print the diagram
print(sankey)
library(shiny); runApp('C:/Users/Adithya/AppData/Local/Microsoft/Windows/INetCache/IE/MKFI1O3S/app[1].R')
runApp('C:/Users/Adithya/AppData/Local/Microsoft/Windows/INetCache/IE/7RJSM81C/new[1].R')
runApp('C:/Users/Adithya/AppData/Local/Microsoft/Windows/INetCache/IE/7RJSM81C/new[1].R')
runApp('sankey_new.R')
runApp('sankey_new.R')
runApp('sankey_new.R')
runApp('sankey_new.R')
install.packages("openxlsx")
runApp('sankey_new.R')
runApp('sankey_new.R')
runApp('sankey_new.R')
runApp('sankey_new.R')
runApp('sankey_new.R')
runApp('C:/Users/Adithya/AppData/Local/Microsoft/Windows/INetCache/IE/MKFI1O3S/app[1].R')
